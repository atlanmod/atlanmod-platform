os: linux
sudo: false
dist: trusty

language: java
jdk: oraclejdk8

cache:
    directories:
        - '$HOME/.m2/repository'
        - '$HOME/.sonar/cache'

addons:
    sonarcloud:
        organization: "atlanmod"
        token:
            secure: "bQjV8qO+x8R7bT/FQgHGdad0uELUxr/GWA6aJREQHc0HWvh2tAl7VH3BiUB+XqLY982tjEDVADNiQI1+WQTMe8Jz46bvffrRnJ/cZ401bwEJzVvToROwegHrsGnLOGglIWmDj/ZlIha1OKVzn8rlKQvCI5Bbgxh2akO5je0ukpraQpJFr1t3QXrr5BYhINQiRbyxJF7YiFhTDsunMQnqXiWaH/HJ4/cT1GUVC09kkEKhlWygGIiW4HI4LfpoAq4fYxoxBFGN+ZGaI2oCLRaWbJWvVgrIAAztwMqgBwGG0V7xzkus6jYMeQEnMuFCvBfc3Nse2ZE/AO4G4wDUtGxim+LEvBQI/MaXxZRDVCVVY+TN7p132JtkqLz35k3JsGsz4zIzLQi6vMqmxlZokSSCVtLLd32+5MCfu906m0J8xAXyMJVr/6ZHefbRFUTkPSvHoXMKZfXDvd0qEumXb+JxZSLHCgksujl+rcYOQCmTP89VvSvpMiSbKzK6NqJJeutwSqeRPDTc3E+n1K65adn5DFRRf5vOG/1Rt3JQ0VI2CWQ3DDv4djkAZNQRbJQ/k/bAAAu6mi2d9hOhS/A9KnHaPFywNMTnkToJn15/Ar5vO3x8ZBiYsPKO0wPPuLf6blu3VmLHgNKAV05NKnRsXr0Y0P2KNRZ3jXE9rFknzUBQT/c="

before_script:
    #NEEDED TO RUN THE GUI TESTS
    - "export DISPLAY=:99.0"
    - "sh -e /etc/init.d/xvfb start"
    - sleep 3 # give xvfb some time to start

init_submodules:
    #UPDATE SUBMODULES
    - git submodule update --init --recursive

install:
    #LOCALLY INSTALL sexp2emf
    - git clone --depth 1 https://github.com/atlanmod/sexp2emf.git
    - mvn --batch-mode -Dmaven.javadoc.skip=true --file sexp2emf/pom.xml install

script:
    #ENFORCE MAVEN VERSION
    - mvn -pl . enforcer:enforce
    #BUILD SCRIPT AND REPORTS
    - travis_wait 80 mvn -B -V -q -DskipTests --global-toolchains .travis.maven.toolchains.xml -P photon install jxr:aggregate site

after_success:
#DEPLOYMENT SCRIPTS
